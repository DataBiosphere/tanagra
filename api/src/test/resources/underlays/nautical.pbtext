# proto-file: proto/bio/terra/tanagra/underlay/underlay.proto
# proto-message: Underlay
# An Underlay prototext file describing a fictional relational domain of sailors, boats and
# reservations for testing.
# This should be euivalent to nautical.yaml

name: "nautical_underlay"
entities: {
  name: "sailors"
  attributes: {
    name: "id"
    data_type: INT64
  }
  attributes: {
    name: "name"
    data_type: STRING
  }
  attributes: {
    name: "rating"
    data_type: INT64
  }
}
entities: {
  name: "boats"
  attributes: {
    name: "id"
    data_type: INT64
  }
  attributes: {
    name: "name"
    data_type: STRING
  }
  attributes: {
    name: "color"
    data_type: STRING
  }
  attributes: {
    name: "type_id"
    data_type: INT64
  }
  attributes: {
    name: "type_name"
    data_type: STRING
  }
}
entities: {
  name: "reservations"
  attributes: {
    name: "id"
    data_type: INT64
  }
  attributes: {
    name: "sailors_id"
    data_type: INT64
  }
  attributes: {
    name: "boats_id"
    data_type: INT64
  }
  attributes: {
    name: "day"
    data_type: STRING
  }
}
entities: {
  name: "boat_engines"
  attributes: {
    name: "id"
    data_type: INT64
  }
  attributes: {
    name: "name"
    data_type: STRING
  }
}
relationships: {
  name: "sailor_reservation"
  entity1: "sailors"
  entity2: "reservations"
}
relationships: {
  name: "boat_reservation"
  entity1: "boats"
  entity2: "reservations"
}
datasets: {
  name: "nautical"
  big_query_dataset: {
    project_id: "my-project-id"
    dataset_id: "nautical"
  }
  tables: {
    name: "sailors"
    columns: {
      name: "s_id"
      data_type: INT64
    }
    columns: {
      name: "s_name"
      data_type: STRING
    }
    columns: {
      name: "rating"
      data_type: INT64
    }
  }
  tables: {
    name: "boats"
    columns: {
      name: "b_id"
      data_type: INT64
    }
    columns: {
      name: "b_name"
      data_type: STRING
    }
    columns: {
      name: "color"
      data_type: STRING
    }
    columns: {
      name: "bt_id"
      data_type: INT64
    }
  }
  tables: {
    name: "reservations"
    columns: {
      name: "r_id"
      data_type: INT64
    }
    columns: {
      name: "s_id"
      data_type: INT64
    }
    columns: {
      name: "b_id"
      data_type: INT64
    }
    columns: {
      name: "day"
      data_type: STRING
    }
  }
  tables: {
    name: "boat_types"
    columns: {
      name: "bt_id"
      data_type: INT64
    }
    columns: {
      name: "bt_name"
      data_type: STRING
    }
  }
  tables: {
    name: "boat_types_descendants"
    columns: {
      name: "bt_ancestor"
      data_type: INT64
    }
    columns: {
      name: "bt_descendant"
      data_type: INT64
    }
  }
  tables: {
    name: "boat_parts"
    columns: {
      name: "bp_id"
      data_type: INT64
    }
    columns: {
      name: "bp_name"
      data_type: STRING
    }
    columns: {
      name: "bp_type"
      data_type: STRING
    }
  }
}
entity_mappings: {
  entity: "sailors"
  primary_key: {
    dataset: "nautical"
    table: "sailors"
    column: "s_id"
  }
}
entity_mappings: {
  entity: "boats"
  primary_key: {
    dataset: "nautical"
    table: "boats"
    column: "b_id"
  }
}
entity_mappings: {
  entity: "reservations"
  primary_key: {
    dataset: "nautical"
    table: "reservations"
    column: "r_id"
  }
}
entity_mappings: {
  entity: "boat_engines"
  primary_key: {
    dataset: "nautical"
    table: "boat_parts"
    column: "bp_id"
  }
  table_filter: {
    column_filter: {
      column: {
        dataset: "nautical"
        table: "boat_parts"
        column: "bp_type"
      }
      string_val: "engine"
    }
  }
}
attribute_mappings: {
  attribute: {
    entity: "sailors"
    attribute: "id"
  }
  simple_column: {
    column_id: {
      dataset: "nautical"
      table: "sailors"
      column: "s_id"
    }
  }
}
attribute_mappings: {
  attribute: {
    entity: "sailors"
    attribute: "name"
  }
  simple_column: {
    column_id: {
      dataset: "nautical"
      table: "sailors"
      column: "s_name"
    }
  }
}
attribute_mappings: {
  attribute: {
    entity: "sailors"
    attribute: "rating"
  }
  simple_column: {
    column_id: {
      dataset: "nautical"
      table: "sailors"
      column: "rating"
    }
  }
}
attribute_mappings: {
  attribute: {
    entity: "boats"
    attribute: "id"
  }
  simple_column: {
    column_id: {
      dataset: "nautical"
      table: "boats"
      column: "b_id"
    }
  }
}
attribute_mappings: {
  attribute: {
    entity: "boats"
    attribute: "name"
  }
  simple_column: {
    column_id: {
      dataset: "nautical"
      table: "boats"
      column: "b_name"
    }
  }
}
attribute_mappings: {
  attribute: {
    entity: "boats"
    attribute: "color"
  }
  simple_column: {
    column_id: {
      dataset: "nautical"
      table: "boats"
      column: "color"
    }
  }
}
attribute_mappings: {
  attribute: {
    entity: "boats"
    attribute: "type_id"
  }
  simple_column: {
    column_id: {
      dataset: "nautical"
      table: "boats"
      column: "bt_id"
    }
  }
}
attribute_mappings: {
  attribute: {
    entity: "boats"
    attribute: "type_name"
  }
  lookup_column: {
    primary_table_lookup_key: {
      dataset: "nautical"
      table: "boats"
      column: "bt_id"
    }
    lookup_table_key: {
      dataset: "nautical"
      table: "boat_types"
      column: "bt_id"
    }
    lookup_column: {
      dataset: "nautical"
      table: "boat_types"
      column: "bt_name"
    }
  }
}
attribute_mappings: {
  attribute: {
    entity: "reservations"
    attribute: "id"
  }
  simple_column: {
    column_id: {
      dataset: "nautical"
      table: "reservations"
      column: "r_id"
    }
  }
}
attribute_mappings: {
  attribute: {
    entity: "reservations"
    attribute: "sailors_id"
  }
  simple_column: {
    column_id: {
      dataset: "nautical"
      table: "reservations"
      column: "s_id"
    }
  }
}
attribute_mappings: {
  attribute: {
    entity: "reservations"
    attribute: "boats_id"
  }
  simple_column: {
    column_id: {
      dataset: "nautical"
      table: "reservations"
      column: "b_id"
    }
  }
}
attribute_mappings: {
  attribute: {
    entity: "reservations"
    attribute: "day"
  }
  simple_column: {
    column_id: {
      dataset: "nautical"
      table: "reservations"
      column: "day"
    }
  }
}
attribute_mappings: {
  attribute: {
    entity: "boat_engines"
    attribute: "id"
  }
  simple_column: {
    column_id: {
      dataset: "nautical"
      table: "boat_parts"
      column: "bp_id"
    }
  }
}
attribute_mappings: {
  attribute: {
    entity: "boat_engines"
    attribute: "name"
  }
  simple_column: {
    column_id: {
      dataset: "nautical"
      table: "boat_parts"
      column: "bp_name"
    }
  }
}
relationship_mappings: {
  name: "sailor_reservation"
  foreign_key: {
    primary_key: {
      dataset: "nautical"
      table: "sailors"
      column: "s_id"
    }
    foreign_key: {
      dataset: "nautical"
      table: "reservations"
      column: "s_id"
    }
  }
}
relationship_mappings: {
  name: "boat_reservation"
  foreign_key: {
    primary_key: {
      dataset: "nautical"
      table: "boats"
      column: "b_id"
    }
    foreign_key: {
      dataset: "nautical"
      table: "reservations"
      column: "b_id"
    }
  }
}
entity_filters_schemas: {
  entity: "sailors"
  attributes: {
    attribute_name: "rating"
    integer_bounds_hint: {
      min: 0
      max: 10
    }
  }
  attributes: {
    attribute_name: "name"
  }
  relationships: {
    relationship_name: "sailor_reservation"
  }
}
hierarchies: {
  attribute: {
    entity: "boats"
    attribute: "type_id"
  }
  descendants_table: {
    ancestor: {
      dataset: "nautical"
      table: "boat_types_descendants"
      column: "bt_ancestor"
    }
    descendant: {
      dataset: "nautical"
      table: "boat_types_descendants"
      column: "bt_descendant"
    }
  }
}
entity_filters_schemas: {
  entity: "reservations"
  attributes: {
    attribute_name: "day"
    enum_hint: {
      enum_hint_values: {
        display_name: "Monday"
        string_val: "MONDAY"
      }
      enum_hint_values: {
        display_name: "Tuesday"
        string_val: "TUESDAY"
      }
      enum_hint_values: {
        display_name: "Wednesday"
        string_val: "WEDNESDAY"
      }
    }
  }
}
