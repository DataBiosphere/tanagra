{
  "name" : "visit_occurrence",
  "idAttribute" : "id",
  "attributes" : [ {
    "type" : "SIMPLE",
    "name" : "end_date",
    "dataType" : "DATE"
  }, {
    "type" : "SIMPLE",
    "name" : "source_criteria_id",
    "dataType" : "INT64",
    "displayHint" : {
      "type" : "RANGE",
      "minVal" : 2.000093142E9,
      "maxVal" : 2.004794154E9
    }
  }, {
    "type" : "SIMPLE",
    "name" : "age_at_event",
    "dataType" : "INT64",
    "displayHint" : {
      "type" : "RANGE",
      "minVal" : -977.0,
      "maxVal" : 89.0
    }
  }, {
    "type" : "SIMPLE",
    "name" : "age_at_occurrence",
    "dataType" : "INT64"
  }, {
    "type" : "SIMPLE",
    "name" : "id",
    "dataType" : "INT64"
  }, {
    "type" : "KEY_AND_DISPLAY",
    "name" : "visit",
    "dataType" : "INT64",
    "displayHint" : {
      "type" : "ENUM",
      "enumVals" : [ {
        "enumVal" : {
          "value" : {
            "int64Val" : 9203
          },
          "display" : "Emergency Room Visit"
        },
        "count" : 1690886
      }, {
        "enumVal" : {
          "value" : {
            "int64Val" : 9201
          },
          "display" : "Inpatient Visit"
        },
        "count" : 3078021
      }, {
        "enumVal" : {
          "value" : {
            "int64Val" : 0
          },
          "display" : "No matching concept"
        },
        "count" : 1077644
      }, {
        "enumVal" : {
          "value" : {
            "int64Val" : 9202
          },
          "display" : "Outpatient Visit"
        },
        "count" : 57044408
      } ]
    }
  }, {
    "type" : "SIMPLE",
    "name" : "source_value",
    "dataType" : "STRING",
    "displayHint" : {
      "type" : "ENUM",
      "enumVals" : [ {
        "enumVal" : {
          "value" : {
            "stringVal" : "0"
          },
          "display" : "0"
        },
        "count" : 10
      }, {
        "enumVal" : {
          "value" : {
            "stringVal" : "1"
          },
          "display" : "1"
        },
        "count" : 95
      }, {
        "enumVal" : {
          "value" : {
            "stringVal" : "10"
          },
          "display" : "10"
        },
        "count" : 806601
      }, {
        "enumVal" : {
          "value" : {
            "stringVal" : "2"
          },
          "display" : "2"
        },
        "count" : 396579
      }, {
        "enumVal" : {
          "value" : {
            "stringVal" : "3"
          },
          "display" : "3"
        },
        "count" : 66882
      }, {
        "enumVal" : {
          "value" : {
            "stringVal" : "4"
          },
          "display" : "4"
        },
        "count" : 73037
      }, {
        "enumVal" : {
          "value" : {
            "stringVal" : "5"
          },
          "display" : "5"
        },
        "count" : 40791
      }, {
        "enumVal" : {
          "value" : {
            "stringVal" : "6"
          },
          "display" : "6"
        },
        "count" : 701
      }, {
        "enumVal" : {
          "value" : {
            "stringVal" : "7"
          },
          "display" : "7"
        },
        "count" : 236934
      }, {
        "enumVal" : {
          "value" : {
            "stringVal" : "8"
          },
          "display" : "8"
        },
        "count" : 26854
      }, {
        "enumVal" : {
          "value" : {
            "stringVal" : "9"
          },
          "display" : "9"
        },
        "count" : 63067
      }, {
        "enumVal" : {
          "value" : {
            "stringVal" : "A"
          },
          "display" : "A"
        },
        "count" : 447030
      }, {
        "enumVal" : {
          "value" : {
            "stringVal" : "Ancillary Procedure"
          },
          "display" : "Ancillary Procedure"
        },
        "count" : 336027
      }, {
        "enumVal" : {
          "value" : {
            "stringVal" : "Anesthesia"
          },
          "display" : "Anesthesia"
        },
        "count" : 503253
      }, {
        "enumVal" : {
          "value" : {
            "stringVal" : "Anesthesia Event"
          },
          "display" : "Anesthesia Event"
        },
        "count" : 509269
      }, {
        "enumVal" : {
          "value" : {
            "stringVal" : "Anticoagulation Visit"
          },
          "display" : "Anticoagulation Visit"
        },
        "count" : 294628
      }, {
        "enumVal" : {
          "value" : {
            "stringVal" : "B"
          },
          "display" : "B"
        },
        "count" : 33677
      }, {
        "enumVal" : {
          "value" : {
            "stringVal" : "BMT Presentation"
          },
          "display" : "BMT Presentation"
        },
        "count" : 12
      }, {
        "enumVal" : {
          "value" : {
            "stringVal" : "Behavioral Health Series"
          },
          "display" : "Behavioral Health Series"
        },
        "count" : 2
      }, {
        "enumVal" : {
          "value" : {
            "stringVal" : "C"
          },
          "display" : "C"
        },
        "count" : 537037
      }, {
        "enumVal" : {
          "value" : {
            "stringVal" : "Clinical Support"
          },
          "display" : "Clinical Support"
        },
        "count" : 229373
      }, {
        "enumVal" : {
          "value" : {
            "stringVal" : "Consult"
          },
          "display" : "Consult"
        },
        "count" : 177342
      }, {
        "enumVal" : {
          "value" : {
            "stringVal" : "D"
          },
          "display" : "D"
        },
        "count" : 232318
      }, {
        "enumVal" : {
          "value" : {
            "stringVal" : "Device Check"
          },
          "display" : "Device Check"
        },
        "count" : 74193
      }, {
        "enumVal" : {
          "value" : {
            "stringVal" : "E"
          },
          "display" : "E"
        },
        "count" : 1350672
      }, {
        "enumVal" : {
          "value" : {
            "stringVal" : "Education"
          },
          "display" : "Education"
        },
        "count" : 26932
      }, {
        "enumVal" : {
          "value" : {
            "stringVal" : "Emergency"
          },
          "display" : "Emergency"
        },
        "count" : 340214
      }, {
        "enumVal" : {
          "value" : {
            "stringVal" : "Evaluation"
          },
          "display" : "Evaluation"
        },
        "count" : 134620
      }, {
        "enumVal" : {
          "value" : {
            "stringVal" : "External Hospital Admission"
          },
          "display" : "External Hospital Admission"
        },
        "count" : 222
      }, {
        "enumVal" : {
          "value" : {
            "stringVal" : "F"
          },
          "display" : "F"
        },
        "count" : 26
      }, {
        "enumVal" : {
          "value" : {
            "stringVal" : "Follow-Up"
          },
          "display" : "Follow-Up"
        },
        "count" : 132450
      }, {
        "enumVal" : {
          "value" : {
            "stringVal" : "G"
          },
          "display" : "G"
        },
        "count" : 355082
      }, {
        "enumVal" : {
          "value" : {
            "stringVal" : "H"
          },
          "display" : "H"
        },
        "count" : 19113
      }, {
        "enumVal" : {
          "value" : {
            "stringVal" : "Hospice"
          },
          "display" : "Hospice"
        },
        "count" : 322
      }, {
        "enumVal" : {
          "value" : {
            "stringVal" : "Hospice F2F Visit"
          },
          "display" : "Hospice F2F Visit"
        },
        "count" : 7
      }, {
        "enumVal" : {
          "value" : {
            "stringVal" : "I"
          },
          "display" : "I"
        },
        "count" : 920609
      }, {
        "enumVal" : {
          "value" : {
            "stringVal" : "Infusion"
          },
          "display" : "Infusion"
        },
        "count" : 222006
      }, {
        "enumVal" : {
          "value" : {
            "stringVal" : "Inpatient"
          },
          "display" : "Inpatient"
        },
        "count" : 267518
      }, {
        "enumVal" : {
          "value" : {
            "stringVal" : "J"
          },
          "display" : "J"
        },
        "count" : 25527
      }, {
        "enumVal" : {
          "value" : {
            "stringVal" : "K"
          },
          "display" : "K"
        },
        "count" : 11122
      }, {
        "enumVal" : {
          "value" : {
            "stringVal" : "L"
          },
          "display" : "L"
        },
        "count" : 31288
      }, {
        "enumVal" : {
          "value" : {
            "stringVal" : "Lab"
          },
          "display" : "Lab"
        },
        "count" : 1535333
      }, {
        "enumVal" : {
          "value" : {
            "stringVal" : "Lab Requisition"
          },
          "display" : "Lab Requisition"
        },
        "count" : 15106
      }, {
        "enumVal" : {
          "value" : {
            "stringVal" : "Lab Specimen"
          },
          "display" : "Lab Specimen"
        },
        "count" : 177180
      }, {
        "enumVal" : {
          "value" : {
            "stringVal" : "Lactation Encounter"
          },
          "display" : "Lactation Encounter"
        },
        "count" : 9864
      }, {
        "enumVal" : {
          "value" : {
            "stringVal" : "M"
          },
          "display" : "M"
        },
        "count" : 12
      }, {
        "enumVal" : {
          "value" : {
            "stringVal" : "Medication Management"
          },
          "display" : "Medication Management"
        },
        "count" : 45661
      }, {
        "enumVal" : {
          "value" : {
            "stringVal" : "Mobile Behavioral Health"
          },
          "display" : "Mobile Behavioral Health"
        },
        "count" : 65749
      }, {
        "enumVal" : {
          "value" : {
            "stringVal" : "NULL"
          },
          "display" : "NULL"
        },
        "count" : 13869438
      }, {
        "enumVal" : {
          "value" : {
            "stringVal" : "Newborn"
          },
          "display" : "Newborn"
        },
        "count" : 150
      }, {
        "enumVal" : {
          "value" : {
            "stringVal" : "Nuclear Medicine"
          },
          "display" : "Nuclear Medicine"
        },
        "count" : 10927
      }, {
        "enumVal" : {
          "value" : {
            "stringVal" : "Nurse Only"
          },
          "display" : "Nurse Only"
        },
        "count" : 182857
      }, {
        "enumVal" : {
          "value" : {
            "stringVal" : "Nurse Triage"
          },
          "display" : "Nurse Triage"
        },
        "count" : 46544
      }, {
        "enumVal" : {
          "value" : {
            "stringVal" : "Nutrition"
          },
          "display" : "Nutrition"
        },
        "count" : 81148
      }, {
        "enumVal" : {
          "value" : {
            "stringVal" : "O"
          },
          "display" : "O"
        },
        "count" : 635991
      }, {
        "enumVal" : {
          "value" : {
            "stringVal" : "OP"
          },
          "display" : "OP"
        },
        "count" : 127974
      }, {
        "enumVal" : {
          "value" : {
            "stringVal" : "Observation"
          },
          "display" : "Observation"
        },
        "count" : 51247
      }, {
        "enumVal" : {
          "value" : {
            "stringVal" : "Office Visit"
          },
          "display" : "Office Visit"
        },
        "count" : 6472561
      }, {
        "enumVal" : {
          "value" : {
            "stringVal" : "Ophth After Hours"
          },
          "display" : "Ophth After Hours"
        },
        "count" : 1264
      }, {
        "enumVal" : {
          "value" : {
            "stringVal" : "Ophth Exam"
          },
          "display" : "Ophth Exam"
        },
        "count" : 14082
      }, {
        "enumVal" : {
          "value" : {
            "stringVal" : "Outpatient"
          },
          "display" : "Outpatient"
        },
        "count" : 1542812
      }, {
        "enumVal" : {
          "value" : {
            "stringVal" : "P"
          },
          "display" : "P"
        },
        "count" : 55
      }, {
        "enumVal" : {
          "value" : {
            "stringVal" : "PA"
          },
          "display" : "PA"
        },
        "count" : 2303
      }, {
        "enumVal" : {
          "value" : {
            "stringVal" : "PV"
          },
          "display" : "PV"
        },
        "count" : 149483
      }, {
        "enumVal" : {
          "value" : {
            "stringVal" : "Postpartum Visit"
          },
          "display" : "Postpartum Visit"
        },
        "count" : 23
      }, {
        "enumVal" : {
          "value" : {
            "stringVal" : "Procedure visit"
          },
          "display" : "Procedure visit"
        },
        "count" : 273087
      }, {
        "enumVal" : {
          "value" : {
            "stringVal" : "Q"
          },
          "display" : "Q"
        },
        "count" : 42
      }, {
        "enumVal" : {
          "value" : {
            "stringVal" : "R"
          },
          "display" : "R"
        },
        "count" : 20595
      }, {
        "enumVal" : {
          "value" : {
            "stringVal" : "Radiation Oncology"
          },
          "display" : "Radiation Oncology"
        },
        "count" : 17419
      }, {
        "enumVal" : {
          "value" : {
            "stringVal" : "Radiation/Oncology Series"
          },
          "display" : "Radiation/Oncology Series"
        },
        "count" : 90875
      }, {
        "enumVal" : {
          "value" : {
            "stringVal" : "Retail"
          },
          "display" : "Retail"
        },
        "count" : 22514
      }, {
        "enumVal" : {
          "value" : {
            "stringVal" : "Routine Prenatal"
          },
          "display" : "Routine Prenatal"
        },
        "count" : 247568
      }, {
        "enumVal" : {
          "value" : {
            "stringVal" : "S"
          },
          "display" : "S"
        },
        "count" : 218377
      }, {
        "enumVal" : {
          "value" : {
            "stringVal" : "Same Day Procedure"
          },
          "display" : "Same Day Procedure"
        },
        "count" : 413700
      }, {
        "enumVal" : {
          "value" : {
            "stringVal" : "Social Work"
          },
          "display" : "Social Work"
        },
        "count" : 53441
      }, {
        "enumVal" : {
          "value" : {
            "stringVal" : "Specialty Pharmacy Services"
          },
          "display" : "Specialty Pharmacy Services"
        },
        "count" : 19546
      }, {
        "enumVal" : {
          "value" : {
            "stringVal" : "Surgery"
          },
          "display" : "Surgery"
        },
        "count" : 603899
      }, {
        "enumVal" : {
          "value" : {
            "stringVal" : "Surgery Admit"
          },
          "display" : "Surgery Admit"
        },
        "count" : 12370
      }, {
        "enumVal" : {
          "value" : {
            "stringVal" : "T"
          },
          "display" : "T"
        },
        "count" : 547
      }, {
        "enumVal" : {
          "value" : {
            "stringVal" : "Telemedicine"
          },
          "display" : "Telemedicine"
        },
        "count" : 373210
      }, {
        "enumVal" : {
          "value" : {
            "stringVal" : "Therapy/Rehab Series"
          },
          "display" : "Therapy/Rehab Series"
        },
        "count" : 19
      }, {
        "enumVal" : {
          "value" : {
            "stringVal" : "Treatment"
          },
          "display" : "Treatment"
        },
        "count" : 356694
      }, {
        "enumVal" : {
          "value" : {
            "stringVal" : "V"
          },
          "display" : "V"
        },
        "count" : 270621
      }, {
        "enumVal" : {
          "value" : {
            "stringVal" : "W"
          },
          "display" : "W"
        },
        "count" : 85
      }, {
        "enumVal" : {
          "value" : {
            "stringVal" : "X"
          },
          "display" : "X"
        },
        "count" : 25932590
      }, {
        "enumVal" : {
          "value" : {
            "stringVal" : "Y"
          },
          "display" : "Y"
        },
        "count" : 2510
      }, {
        "enumVal" : {
          "value" : {
            "stringVal" : "Z"
          },
          "display" : "Z"
        },
        "count" : 44
      } ]
    }
  }, {
    "type" : "SIMPLE",
    "name" : "person_id",
    "dataType" : "INT64",
    "displayHint" : {
      "type" : "RANGE",
      "minVal" : 1.0,
      "maxVal" : 5227737.0
    }
  }, {
    "type" : "SIMPLE",
    "name" : "start_date",
    "dataType" : "DATE"
  } ],
  "sourceDataMapping" : {
    "dataPointer" : "omop_dataset",
    "tablePointer" : {
      "rawSql" : "/* Add age_at_event column */ SELECT     /* Can't do \"*\". During expansion, there's an error about person_id column being ambiguous. */     v.visit_occurrence_id, v.visit_concept_id, v.person_id, v.visit_start_date, v.visit_end_date, v.visit_source_value, v.visit_source_concept_id,      /* https://stackoverflow.com/a/70433423/6447189 */     DATE_DIFF(DATE(v.visit_start_datetime), DATE(p.birth_datetime), YEAR) -     IF(EXTRACT(MONTH FROM DATE(p.birth_datetime))*100 + EXTRACT(DAY FROM DATE(p.birth_datetime)) >       EXTRACT(MONTH FROM DATE(v.visit_start_datetime))*100 + EXTRACT(DAY FROM DATE(v.visit_start_datetime))       ,1,0) AS age_at_event FROM     `victr-tanagra-test.sd_static.visit_occurrence` v,     `victr-tanagra-test.sd_static.person` p WHERE v.person_id = p.person_id "
    },
    "attributeMappings" : {
      "end_date" : {
        "value" : {
          "column" : "visit_end_date"
        }
      },
      "source_criteria_id" : {
        "value" : {
          "column" : "visit_source_concept_id"
        }
      },
      "age_at_event" : {
        "value" : {
          "column" : "age_at_event"
        }
      },
      "id" : {
        "value" : {
          "column" : "visit_occurrence_id"
        }
      },
      "visit" : {
        "value" : {
          "column" : "visit_concept_id"
        },
        "display" : {
          "column" : "visit_concept_id",
          "foreignTable" : "concept",
          "foreignKey" : "concept_id",
          "foreignColumn" : "concept_name"
        }
      },
      "source_value" : {
        "value" : {
          "column" : "visit_source_value"
        }
      },
      "person_id" : {
        "value" : {
          "column" : "person_id"
        }
      },
      "start_date" : {
        "value" : {
          "column" : "visit_start_date"
        }
      }
    },
    "hierarchyMappings" : { }
  },
  "indexDataMapping" : {
    "dataPointer" : "index_dataset",
    "tablePointer" : {
      "table" : "visit_occurrence"
    },
    "attributeMappings" : {
      "end_date" : {
        "value" : {
          "column" : "end_date"
        }
      },
      "source_criteria_id" : {
        "value" : {
          "column" : "source_criteria_id"
        }
      },
      "age_at_event" : {
        "value" : {
          "column" : "age_at_event"
        }
      },
      "id" : {
        "value" : {
          "column" : "id"
        }
      },
      "visit" : {
        "value" : {
          "column" : "visit"
        },
        "display" : {
          "column" : "t_display_visit"
        }
      },
      "source_value" : {
        "value" : {
          "column" : "source_value"
        }
      },
      "person_id" : {
        "value" : {
          "column" : "person_id"
        }
      },
      "start_date" : {
        "value" : {
          "column" : "start_date"
        }
      }
    },
    "hierarchyMappings" : { }
  },
  "sourceStartDateColumn" : {
    "column" : "visit_start_datetime"
  }
}
